<!DOCTYPE html>
<html lang="ar-AE" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>اختبار الموقع - هدايا الإمارات</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<style>/* نفس الأنماط السابقة */</style>
</head>
<body>
<div id="app">جاري التحميل...</div>
<script>
// تحميل الأنظمة مع انتظار جاهزية الكائن
function loadScript(src){return new Promise((res,rej)=>{const s=document.createElement('script');s.src=src;s.onload=res;s.onerror=()=>rej(new Error('load fail '+src));document.head.appendChild(s);});}
async function boot(){
 try{
  await loadScript('./js/popup-system.js');
  const waitReady = ()=> new Promise(r=>{
    let tries=0; const t=setInterval(()=>{tries++; if(window.EmiratesSalesNotifications && typeof window.EmiratesSalesNotifications.addRealtimeSale==='function'){clearInterval(t); r(true);} if(tries>50){clearInterval(t); r(false);}},100);
  });
  const ready = await waitReady();
  const el=document.getElementById('app');
  if(ready){
    el.innerHTML='✅ النظام جاهز. سيتم عرض إشعار اختباري خلال ثانيتين.';
    setTimeout(()=>window.EmiratesSalesNotifications.addRealtimeSale('محمد الاختبار','دبي','عطر ARIAF فاخر (اختبار)','perfume_27'),2000);
  }else{
    el.innerHTML='❌ لم يتم تحميل الدالة addRealtimeSale. تحقق من الكاش أو التعارض مع إضافات المتصفح.';
  }
 }catch(e){document.getElementById('app').innerHTML='خطأ: '+e.message}
}
boot();
</script>
</body>
</html>