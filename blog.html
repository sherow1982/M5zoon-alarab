<!doctype html>
<html lang="ar-KW" dir="rtl">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مدونة المتجر الكويتي - نصائح ومراجعات المنتجات</title>
    <meta name="description" content="اقرأ أحدث المقالات والمراجعات حول المنتجات لمساعدتك على اتخاذ أفضل قرار شراء في الكويت.">
    <link rel="stylesheet" href="./woodmart-lite.css">
    <link rel="icon" href="./favicon.ico">
</head>
<body>
    <header class="header">
        <div class="header__inner container">
            <a href="./" class="header__logo"><h1>المتجر الكويتي</h1></a>
            <div class="header__spacer"></div>
            <nav class="main-nav">
                <a href="./blog.html" target="_blank" rel="noopener noreferrer">المدونة</a>
                <a href="./about.html" target="_blank" rel="noopener noreferrer">من نحن</a>
                <a href="./shipping-policy.html" target="_blank" rel="noopener noreferrer">سياسة الشحن</a>
            </nav>
        </div>
    </header>
    <main class="section">
        <div class="container">
            <h1>مدونة المتجر</h1>
            <p>مراجعات شاملة ونصائح الخبراء لمنتجاتنا الأكثر مبيعاً في الكويت.</p>
            <div id="blog-posts-container">
                <p>جارٍ تحميل المقالات...</p>
            </div>
        </div>
    </main>
    <footer class="footer">
        <nav class="footer-nav container">
            <a href="./about.html" target="_blank" rel="noopener noreferrer">من نحن</a>
            <a href="./shipping-policy.html" target="_blank" rel="noopener noreferrer">سياسة الشحن</a>
            <a href="./return-policy.html" target="_blank" rel="noopener noreferrer">الاستبدال والاسترجاع</a>
        </nav>
        <div class="container footer__bottom"><p>&copy; 2025 المتجر الكويتي</p></div>
    </footer>
    <script type="module">
        const DATA_URL = 'https://raw.githubusercontent.com/sherow1982/Kuwait-matjar/refs/heads/main/data/products-template.json?raw=1';
        const container = document.getElementById('blog-posts-container');
        const slugify = (text) => text ? text.toString().toLowerCase().trim().replace(/\s+/g, '-').replace(/[^\u0600-\u06FFa-z0-9-]/g, '').replace(/-+/g, '-') : '';

        const createArticle = (p = {}) => {
            const title = p['العنوان'] || 'منتج غير متوفر';
            const image = p['رابط الصورة'] || '';
            const description = p['الوصف'] || 'لا يوجد وصف متاح لهذا المنتج.';
            const productSlug = slugify(title);
            const productPageLink = `./product.html?name=${productSlug}`;
            const price = p['السعر المخفّض'] || p['السعر'];
            const whatsappMessage = encodeURIComponent(`مرحباً، أريد الاستفسار عن المنتج: ${title} | السعر: ${price}`);
            const whatsappLink = `https://wa.me/201110760081?text=${whatsappMessage}`;

            // Generate SEO-rich description for the article
            const articleText = `هل تبحث عن **${title} في الكويت**؟ يُعتبر هذا المنتج من أفضل الخيارات المتاحة حالياً في السوق الكويتي بفضل ميزاته الرائعة. ${description.substring(0, 150)}...`;

            return `
                <article class="blog-post-summary">
                    <a href="${productPageLink}" target="_blank" rel="noopener noreferrer" class="blog-post-thumb"><img src="${image}" alt="${title}" loading="lazy"></a>
                    <div class="blog-post-content">
                        <h2><a href="${productPageLink}" target="_blank" rel="noopener noreferrer">${title}</a></h2>
                        <p>${articleText}</p>
                        <div class="blog-post-actions">
                            <a href="${productPageLink}" target="_blank" rel="noopener noreferrer" class="btn">عرض التفاصيل</a>
                            <a href="${whatsappLink}" target="_blank" rel="noopener noreferrer" class="btn btn-whatsapp">
                                <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor"><path d="M12.04 2C6.58 2 2.13 6.45 2.13 11.91C2.13 13.66 2.61 15.36 3.48 16.84L2 22L7.32 20.55C8.75 21.33 10.37 21.82 12.04 21.82C17.5 21.82 21.95 17.37 21.95 11.91C21.95 6.45 17.5 2 12.04 2Z"/></svg>
                                اطلب عبر واتساب
                            </a>
                        </div>
                    </div>
                </article>
            `;
        };

        (async () => {
            if(container) {
                try {
                    const res = await fetch(DATA_URL);
                    const items = await res.json();
                    if (items?.length) {
                        container.innerHTML = items.map(createArticle).join('');
                    } else {
                        container.innerHTML = '<p>لا توجد مقالات لعرضها حالياً.</p>';
                    }
                } catch (e) {
                    console.error("خطأ في تحميل مقالات المدونة:", e);
                    container.innerHTML = '<p>حدث خطأ أثناء تحميل المقالات. يرجى المحاولة مرة أخرى لاحقاً.</p>';
                }
            }
        })();
    </script>
</body>
</html>
